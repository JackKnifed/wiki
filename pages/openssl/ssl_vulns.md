topic: ssl
topic: pci
title: SSL Vulnerabilities

SSL Testing
===========

The Transport Layer Security (TLS) protocol aims to provide client and server systems with a means of establishing an encrypted communication channel. 

`SSL` was historically the dominant protocol for securing the Internet, however a rash of attacks is promoting it's successor, `TLS`. However, `TLS` has also been found to have weaknesses and careful configuration is needed to ensure security.

SSL Handshake
-------------

[The SSL Handshake process is as follows](http://www.sans.org/reading-room/whitepapers/protocols/ssl-tls-beginners-guide-1029):

* The client says hello and sends
 * client SSL version number
 * cipher settings/available ciphers
 * compressions methods available on the client
 * a 32 byte randomly generated number
 * blank session id field
* The server says hello and sends
 * server ssl compatbility version number
 * cipher suite to use
 * compression method to use
 * date and time used for 4 bytes of random number, other 28 are generated by random
* The server sends it's public SSL certificate (and if doing two way encryption, requests the client's certificate) 
* The server sends a `ServerHelloDone` to indicate that control goes back to the client
* The client creates a `premaster secret`, encrypts it with the server's public key (conatined in the certificate), and sends this to the server.
* The server decrypts the `premaster secret` with it's private key, then both the client and server run a set of steps dictated by the Cipher to generate symmertic keys from the `premaster secret` - called the `master secret`.
* The client informs the server that further messages will be encrypted, and the client sends an encrypted confirmation message.
* The server informs the client that further messages will be encrypted, and the server sends an encrypted confirmation message.


SSLv2 and SSLv3 Support 
-----------------------

warning> SSLv2 is old. 20 years old. It has weaknesses. It should be disabled.

warning> SSLv3 had some issues, but was considered better than SSLv2 and still in use. Then Google came along and tore it apart. As a result of POODLE, SSLv3 *cannot* be used.

To test whether a system supports SSLv3, the following OpenSSL command can be used:

```bash
openssl s_client -connect google.com:443 -no_tls1
```

If you get output that looks like the below (a successful connection) then either SSLv2 or SSLv3 is enabled.

```nohighlight
CONNECTED(00000003)
depth=2 /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA
verify error:num=20:unable to get local issuer certificate
verify return:0
---
Certificate chain

--- Certificate details removed for brevity ---
---
New, TLSv1/SSLv3, Cipher is RC4-SHA
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : SSLv3
    Cipher    : RC4-SHA
    Session-ID: 6E461AEAD8C1516F9D8950A9B5E735F9882BFC6EA0838D81CFD41C01A3799A41
    Session-ID-ctx:
    Master-Key: 7E7680640BB7E2C83CBE87342727E0D09AC10EEEB095A8C0A2501EAE80FA1C20D3F3FE4346B1234057D6D506420273FA
    Key-Arg   : None
    Start Time: 1421296281
    Timeout   : 7200 (sec)
    Verify return code: 0 (ok)
---
```

A handshake failure error would indicate that SSLv2 and SSLv3 are not supported:

```nohighlight
CONNECTED(00000003)
140410898790056:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure:s3_pkt.c:1261:SSL alert number 40
140410898790056:error:1409E0E5:SSL routines:SSL3_WRITE_BYTES:ssl handshake failure:s3_pkt.c:599:
```

Cipher Suites
-------------

Within the protocol, the SSL/TLS protocol negoitates a shared encryption method via the choosen "cipher suite" - or way to encrypt traffic. The fact that the protocol tries to figure out something that the two ends can both use is one of the biggest assets.

Cipher Suites are named things like `TLS_RSA_WITH_AES_128_CBC_SHA` and `TLS_RSA_WITH_AES_128_CBC_SHA` and `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384`. However, they're grouped into groups based on what they use.

The cipher suites a server is configured to support should be dictated by its security requirements. The following guidelines are generally recommended as a baseline:

* Use a key exchange algorithm that provides "perfect forward secrecy", like `DHE` or `ECDHE`.
* Do not use a Cipher that is weak. This rules out `RC4`.
* The cipher should use at least a `128` bit key (which rules out `DES` and `Triple-DES`).
* Cipher-Block Chaining (`CBC`) mode is prone to padding oracle attacks and should ideally be avoided altogether, but specifically it should not be used in conjunction with SSLv3 or TLSv1.0 as this can lead to vulnerability to the `BEAST` attack. An alternative is Galois Counter Mode (GCM) which is not affected by these problems and offers authenticated encryption.
* The message authentication algorithm should ideally be `SHA256` or `SHA2`. `MD5` and `SHA` or `SHA1` should not be used.
* For all three algorithms, the NULL / anon setting should be avoided as these provide no security at all.
* `EXPORT` algorithms should also be disabled as they use short key lengths. `FREAK` dealt with `EXPORT` suites.

Different Ciphers are then grouped together by the above things (and more). Thus, for ease, in OpenSSL you can set your cipher string to promote and deny certain cipher.

There is a lot more information on the different cipher suites and groups available [at the OpenSSL site](https://www.openssl.org/docs/apps/ciphers.html).

SSL Certificates
----------------

SSL/TLS certificates are typically hosted server side, and are actually `x.509` certificates.

On an `x.509` certificate, the following propertities are important:

* `Not Before` - Start date of the cert, it should be in the past.
* `Not After` - Expiration date of the cert. It should not be trusted after this date. Certiicates should be replaced before they expire.
* `Signature Algorithm` - The algorithm used to ensure the certificate's integerity.
 * `MD5` has been comprimised with collision attacks, allowing fake (but valid) keys and certificates to be generated.
 * `SHA1` is phased out due to known weaknesses.
 * `SHA2` encryption should be used (as it is below).
* `Public-Key` - The public key needs to be long enough to ensure that attacks are computationally infeasible.
 * With `RSA`, `2048` bit keys are the current minimum. `4096` are preferred.
* `Issuer` - The entity which issued the certificate. Should be a trusted party recognised by both the client and server.
 * Typically a third-party certificate authority (like DigiCert or GlobalSign), some larger organisations operate their own CA to sign certificates.
 * It is possible to generate a "self-signed" certificates, one signed by an anomyous source. The same encryption level can be used, but the anonymous signer can be replaced with another anonymous signer, allowing for MitM attacks.
* `Subject` - Contains the Primary domain name that the certificate is valid for.
* `Subject Alternative Name` - Contains additional domain names that the certificate is valid for.
 * Any section in a `Subject` or `SAN` that is replaced with a `*` makes the certificate a wildcard certificiate - any value can be substituted for that section.

To view the details of a server's certificate, the following command can be used:

```bash
openssl s_client -connect example.com:443 | openssl x509 -noout -text
```

This will show you something to similar (this is Paypal):

```nohighlight
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            0e:65:41:91:6c:e8:cf:b2:9b:7b:52:71:01:05:ba:c4
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 High Assurance Server CA
        Validity
            Not Before: Dec 12 00:00:00 2014 GMT
            Not After : Dec 16 12:00:00 2016 GMT
        Subject: C=US, ST=California, L=San Jose, O=PayPal, Inc., OU=PayPal Production, CN=paypal.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:d5:c8:b2:65:07:ff:fb:71:0a:cf:a8:77:97:fc:
                    e1:a4:87:5d:79:29:03:e0:1a:5f:c2:f8:71:c9:ac:
                    bc:d3:16:e0:9c:2e:bb:d9:1c:5b:cc:90:7d:e3:54:
                    ab:53:79:50:37:63:b1:cb:68:56:ee:6a:5b:d2:10:
                    38:1a:35:f7:37:12:83:d9:72:51:9e:b7:f9:9c:1d:
                    b8:a9:e6:f3:27:bb:5b:8b:b9:be:fa:39:19:83:d9:
                    cd:66:69:1d:cc:8a:cb:59:b5:53:3e:ca:41:f6:ac:
                    89:4d:58:06:04:a5:e2:c9:94:05:26:6c:24:a6:81:
                    ca:4a:01:11:4c:a2:8d:83:7a:9a:2a:7d:16:93:ca:
                    a0:df:59:b8:e1:38:18:b2:bd:eb:77:6b:57:fb:7f:
                    d6:70:e1:2d:70:dd:cc:af:43:f0:de:a0:fc:2f:8e:
                    94:74:3c:4f:ae:ca:f6:f2:ab:09:7f:63:71:b6:27:
                    78:4d:f8:e1:e0:86:3a:81:9f:d4:55:45:27:ff:4d:
                    53:2f:99:43:28:ad:fa:c9:63:6f:64:28:36:d7:ea:
                    c3:00:50:88:86:a3:d0:83:ae:be:99:18:25:b2:44:
                    05:c6:e8:36:4a:fb:4d:ab:df:6d:0f:50:3f:80:fc:
                    38:ba:4c:53:c1:6d:48:22:68:7a:ed:6e:05:e4:9d:
                    58:ef
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Authority Key Identifier:
                keyid:51:68:FF:90:AF:02:07:75:3C:CC:D9:65:64:62:A2:12:B8:59:72:3B
            X509v3 Subject Key Identifier:
                1F:54:C7:2D:0E:D3:6C:C4:63:FE:66:1C:EA:8C:50:75:3A:01:8F:DE
            X509v3 Subject Alternative Name:
                DNS:paypal.com, DNS:www.paypal.com
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage:
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 CRL Distribution Points:

                Full Name:
                  URI:http://crl3.digicert.com/sha2-ha-server-g3.crl

                Full Name:
                  URI:http://crl4.digicert.com/sha2-ha-server-g3.crl

            X509v3 Certificate Policies:
                Policy: 2.16.840.1.114412.1.1
                  CPS: https://www.digicert.com/CPS

            Authority Information Access:
                OCSP - URI:http://ocsp.digicert.com
                CA Issuers - URI:http://cacerts.digicert.com/DigiCertSHA2HighAssuranceServerCA.crt

            X509v3 Basic Constraints: critical
                CA:FALSE
    Signature Algorithm: sha256WithRSAEncryption
         3d:79:69:48:5d:f6:bc:4b:5f:81:f3:97:9d:61:e5:9c:46:b9:
         73:00:66:09:f1:8a:06:89:14:a3:25:ea:ba:a2:5d:ac:77:3a:
         8f:6a:8a:11:9b:c3:35:67:99:9f:9d:c2:c0:ac:9f:eb:24:58:
         c8:4a:be:07:31:30:8c:69:07:bc:ff:c0:5a:d1:17:c6:05:f7:
         75:ca:fe:cd:98:78:43:41:ac:14:75:f7:c9:10:f4:07:38:58:
         73:6a:84:58:1f:a9:31:7d:28:47:70:98:de:3f:d7:00:82:a6:
         5c:2e:5d:31:96:4a:06:82:a2:a0:02:95:fd:6f:ef:66:4a:57:
         50:c3:1a:84:48:26:47:73:6e:c8:d7:30:fb:75:11:d6:ee:67:
         7e:d4:15:b2:44:15:ef:ee:ab:ba:81:c2:f5:05:04:d1:f3:70:
         bb:96:41:03:eb:d1:e0:e4:3d:57:41:8d:3d:7a:df:f0:c1:68:
         6f:43:68:e1:8d:1e:19:7e:57:aa:49:43:28:2a:f1:8c:f7:0d:
         a4:6a:8c:18:75:6b:a4:cc:a7:2f:e5:21:d1:81:8c:d4:bc:f4:
         00:4c:f6:37:03:a3:61:33:b2:ea:15:34:48:53:83:48:57:6c:
         33:f2:b7:fb:f3:fc:ea:df:0d:d0:e2:49:01:b4:23:c9:3d:7a:
         f4:42:4f:98
```


Poor Cipher Choices
-------------------

### Perfect Forward Secrecy ###

Not every server uses unique random numbers in the random portions of the SSL handshake. PFS is a way of making sure that you're using different random numbers each time. The following certificates will let you do this

* `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA`
* `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA`
* `TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA`

Renegotiation
-------------

There is a way for the client and server to renegotiate new encryption keys during a session. A vulnerability was discovered in 2009 where an attacker could exploit the renegotiation process and inject content into the start of the session, compromising the integrity of the session.

This is only a concern if you can:
* Renegotiate the connection
* Secure renegotiation is not enabled.

### Client Initiated Renegotiation ###

The following demonstrates how to check if client initiated renegotiation is supported.

```bash
openssl s_client -connect example.com:443
```

Once the connection is established, the server will wait for us to type the next command. We can write the following two lines in order to initiate a renegotiation by specifying R in the second line, followed by enter or return.

```nohighlight
openssl s_client -connect host:port
HEAD / HTTP/1.0
R
<Enter or Return key>
```

A system that does not support client initiated renegotiation will return an error and end the connection, or the connection will time out.

```nohighlight
RENEGOTIATING
write:errno=104
```

A system that supports client initiated renegotiation will keep the connection active, and respond to further commands.  

### Secure Renegotiation ###

The following demonstrates how to verify if a system supports secure renegotiation.

```bash
openssl s_client -connect example.com:443
```

A system that does not support secure renegotiation will return the following when a connection is established.

```nohighlight
CONNECTED(00000003)
139677333890704:error:1407F0E5:SSL routines:SSL2_WRITE:ssl handshake failure:s2_pkt.c:429:
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 36 bytes
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : SSLv2
    Cipher    : 0000
    Session-ID: 
    Session-ID-ctx: 
    Master-Key: 
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    Start Time: 1428910482
    Timeout   : 300 (sec)
    Verify return code: 0 (ok)
---
```

Compression
-----------

Compression was used in the `CRIME` and `BREACH` attacks.

### CRIME ###
The *Compression Ratio Info-leak Made Easy* (`CRIME`) attack is a side-channel attack against TLS compression. The attacker partially controls the content of requests made by the client - for instance with an `XSS` vulnerability. The attacker can then observe the compressed size of these requests on the network and from that infer the contents of the remainder of the request (e.g. session cookies) based on the level of compression achieved.

To test whether a server supports TLS compression, and is vulnerable to CRIME, the following method can be used: 

```
openssl s_client -connect example.com:443
```

On the servers supporting compression, a response similar to the one below will be received, containing details about the compression. The lines "Compression: zlib compression" and "Compression: 1 (zlib compression)" indicate that the remote server is vulnerable to the CRIME attack. 

```nohighlight
---
New, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: zlib compression
Expansion: zlib compression
SSL-Session:
    Protocol  : TLSv1.1
    Cipher    : DHE-RSA-AES256-SHA
    Session-ID: 50791A02E03E42F8983344B25C8ED4598620518D5C917A3388239AAACE991858
    Session-ID-ctx: 
    Master-Key: 9FEDB91F439775B49A5C49342FF53C3DD7384E4AFC33F9C6AFB64EA3D639CA57253AD7D059BA54E01581AD3A73306342
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 300 (seconds)
    TLS session ticket:
    0000 - 34 38 24 70 35 88 4a 68-0c 80 e6 c5 76 a1 0e ee   48$p5.Jh....v...
    0010 - 14 2e fb ef fa 42 f0 c1-58 ee 70 02 90 45 f4 8c   .....B..X.p..E..
    0020 - 7d 0b 2e 1e 71 70 b0 a2-cc 27 1b 13 29 cc f5 ee   }...qp...'..)...
    0030 - 84 43 98 fa b1 ae 83 dc-ff 6d aa 07 9f 7a 95 4f   .C.......m...z.O
    0040 - 44 68 63 21 72 d7 b9 18-97 d8 8e d7 61 7d 71 6f   Dhc!r.......a}qo
    0050 - a7 16 85 79 f9 a2 80 2a-b4 bc f9 47 78 6a b7 08   ...y...*...Gxj..
    0060 - f6 4f 09 96 7b e8 d4 9b-26 2d 1a fd 55 fe 6a ab   .O..{...&-..U.j.
    0070 - fc 8d 6d 87 7a 13 e1 a9-0a 05 09 d9 ce ea fe 70   ..m.z..........p
    0080 - 09 c9 5f 33 3c 5f 28 4e-20 3b 3a 10 75 c4 86 45   .._3<_(N ;:.u..E
    0090 - 1d 8b c8 a5 21 89 a1 12-59 b6 0f 55 e3 48 8f 91   ....!...Y..U.H..
    00a0 - 01 af 53 b6                                       ..S.

    Compression: 1 (zlib compression)
    Start Time: 1348073759
    Timeout   : 300 (sec)
    Verify return code: 20 (unable to get local issuer certificate)
---
```
 

For servers that have TLS compression disabled, the response will be similar to the following. The "Compression: NONE" shows that this server rejects usage of TLS-level compression. 

```nohighlight
---
New, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES128-GCM-SHA256
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : ECDHE-RSA-AES128-GCM-SHA256
    Session-ID: 7E49EA6457B200B441A26C05F1AE9634AAF97284AC7A12EC58F69CEF5470B052
    Session-ID-ctx: 
    Master-Key: E035F082F5545424373A546A1F76D77673E8AEE018B3F0A3AFD7A3545746013664C18E6BB69F08BFAECA6C7FB3010C9C
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 100800 (seconds)
    TLS session ticket:
    0000 - 66 72 6f 6e 74 70 61 67-65 61 61 61 61 61 61 61   frontpageaaaaaaa
    0010 - 89 55 c6 6a 92 c3 28 85-86 b0 ff c3 08 12 5a a8   .U.j..(.......Z.
    0020 - f2 ec f8 56 6d d3 29 99-7b 98 90 ef 57 fd c6 15   ...Vm.).{...W...
    0030 - ee a2 53 4b 43 ef 19 ee-41 25 1f 76 28 37 68 b6   ..SKC...A%.v(7h.
    0040 - 64 ca e7 3f 71 01 70 30-35 91 ef bc d8 19 20 4f   d..?q.p05..... O
    0050 - 9d 9e 2c ab 3f 35 5c 3f-65 f8 c6 9a a9 90 fa 60   ..,.?5\?e......`
    0060 - 4d 53 a1 b8 49 8c e7 61-e4 6c e1 51 8e 83 b5 25   MS..I..a.l.Q...%
    0070 - bc 9a 32 d8 fa be 16 a1-ae 3d 8c 0b e3 9e e4 78   ..2......=.....x
    0080 - 77 d7 91 6b a9 a0 01 2b-e1 98 33 d4 2c eb b3 84   w..k...+..3.,...
    0090 - f9 da 0f fa 77 df ac d6-08 b6 34 97 07 d9 b2 58   ....w.....4....X

    Start Time: 1428988675
    Timeout   : 300 (sec)
    Verify return code: 20 (unable to get local issuer certificate)
---
```

### BREACH ###

The `BREACH` attack is analogous to the `CRIME` attack, but this time exploits the use of HTTP compression to again infer the contents of attacker-influenced requests.

To test whether a server supports deflate or compression, the following steps can be performed:

```bash
openssl s_client -connect example.com:443
```

Submitting the following will allow us to see if HTTP compression is supported by the server.

```nohighlight
GET / HTTP/1.1
Host: example.com
Accept-Encoding: compress, gzip
```

If the response contains encoded data, similar to the following response, it indicates that HTTP compression is supported; therefore the remote host is vulnerable.

```nohighlight
HTTP/1.1 200 OK
Server: nginx/1.1.19
Date: Sun, 19 Mar 2015 20:48:31 GMT
Content-Type: text/html
Last-Modified: Thu, 19 Mar 2015 23:34:28 GMT
Transfer-Encoding: chunked
Connection: keep-alive
Content-Encoding: gzip
 
¬ =�A
�0
   �}E�� �/�փg�
�� oP��
��u4��22��,f&4Y��Į9 .�R�oKc�]�`|�o�r
0
```

A system which does not support deflate or compression will ignore the compress header request and respond with uncompressed data, indicating that it is not vulnerable.

Implementation Issues
---------------------

SSL/TLS is only as secure as the configuration it uses. Keeping TLS properly configured is important - a few of the potential problems are:

### Heartbleed  ###

The [Heartbleed bug](http://heartbleed.com/) is a result of a weakness in OpenSSL. It can be exploited to retrieve memory contents of a server/host running a vulnerable version of OpenSSL.

The following versions of OpenSSL are vulnerable:

•	OpenSSL `1.0.1` through `1.0.1f` (inclusive)

The following versions of OpenSSL are not vulnerable:

•	OpenSSL `1.0.1g`

•	OpenSSL `1.0.0` branch 

•	OpenSSL `0.9.8` branch 

There are many scripts publicly available that can be used to test whether a system is affected by this vulnerability. 

Servers accessible from the internet can be tested using the Heartbleed test websites like https://filippo.io/Heartbleed/, which is run by Filippo Valsorda.

Alternatively, Nmap (v6.46 and above) can be used to test this bug by using the ‘ssl-heartbleed.nse’ script.

```bash
nmap -p 443 --script ssl-heartbleed --script-args vulns.showall example.com
```

The output will be similar to the following:

```nohighlight
PORT    STATE SERVICE
443/tcp open  https
| ssl-heartbleed:
|   VULNERABLE:
|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.
|     State: VULNERABLE
|     Risk factor: High
|     Description:
|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.
|
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160
|       http://www.openssl.org/news/secadv_20140407.txt
|_      http://cvedetails.com/cve/2014-0160/
```

### Change Cipher Spec Injection ###
A weakness exists in some versions of OpenSSL which can be exploited by intermediary third parties in order to retrieve sensitive information from encrypted communication.

Affected Versions:

•	OpenSSL `1.0.1` through `1.0.1g`

•	OpenSSL `1.0.0` through `1.0.0l`

•	all versions before OpenSSL `0.9.8y`

Testing requires using publicly available tools, such as the the ‘ssl-ccs-injection’ nmap script by Claudiu Perta, which can be used to test for this vulnerability. This script can be downloaded from https://nmap.org/nsedoc/scripts/ssl-ccs-injection.html.

```bash
nmap -p 443 --script ssl-ccs-injection example.com
```

```nohighlight
PORT    STATE SERVICE
443/tcp open  https
| ssl-ccs-injection:
|   VULNERABLE:
|   SSL/TLS MITM vulnerability (CCS Injection)
|     State: VULNERABLE
|     Risk factor: High
|     Description:
|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before
|       1.0.1h does not properly restrict processing of ChangeCipherSpec
|       messages, which allows man-in-the-middle attackers to trigger use
|       of a zero-length master key in certain OpenSSL-to-OpenSSL
|       communications, and consequently hijack sessions or obtain
|       sensitive information, via a crafted TLS handshake, aka the
|       "CCS Injection" vulnerability.
|
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224
|       http://www.cvedetails.com/cve/2014-0224
|_      http://www.openssl.org/news/secadv_20140605.txt
```
